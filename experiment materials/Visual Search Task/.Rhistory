sft_path <- list.files(path = "data/", pattern = ".csv", full.names = TRUE)
# read file content
sft_data <- sft_path %>%
lapply(read.csv,header=F)
# Unlist and make it as data frame
sft_result <- rbindlist(sft_data, fill = T)
dta <- sft_result %>%
na.omit(.) %>%
as.data.frame(.)
# Column 1: Subject
# Column 2: Session
# Column 3: Target (0: target absent, 1: target present)
# Column 4: Dimension 1 (0: no, 1: low, 2: high)
# Column 5: Dimension 2 (0: no, 1: low, 2: high)
# Column 6: Target on the left or right 1 (1: right, 2: left) p.s. not meaningful for the target absent condition
# Column 7: Trigger number (11: HH and right target; 12: HH and left target; 21: HL and right target; 22: HL and left target; 31: LH and right target; 32: LH and left target; 41: LL and right target; 42: LL and left target; 90: XX and no target)
# Column 8: PIC index (for programming)
# Column 9: PIC name (for programming)
# Column 10: Fixation Time (ms unit)
# Column 11: Response (-1: no response, 1: target absent, 2: target present)
# Column 12: Response Time (ms unit)
# Column 13: Accuracy (0: incorrect, 1: correct)
names(dta) <-   c("Subject", "Session", "Target", "Channel1", "Channel2", "TargetLocation", "Trigger", "XX", "XXX", "Fixtime",
"Response", "RT", "Correct")
# Save data
#write.csv(dta, "/Users/haolunfu/Documents/VO2_EF_SFT/Pretest_all.csv")
# Subject Number
nSubjects <- unique(dta$Subject)
nSubjects
#
dta$Condition <- factor(dta$Trigger,
levels = c("11", "12", "21", "22", "31", "32", "41", "42", "90"),
labels = c("HH", "HH", "HL", "HL", "LH", "LH", "LL", "LL", "XX"))
dta$TargetLocation <- factor(dta$TargetLocation,
levels = c("1", "2"),
labels = c("Right", "Left"))
dta$RT <- as.numeric(dta$RT)
dta$Correct <- as.numeric(dta$Correct)
## Show the first six rows
head(dta)
str(dta)
#########
dta_row <- dta %>%
group_by(Subject, Condition) %>%
summarize(ACC_m=round(mean(Correct),2), RT_m=round(mean(RT),2), RT_sd=round(sd(RT),2), RT_med=round(median(RT),0))
write.csv(dta_row, "results/results_row.csv")
# remove outliers mean +- 3 sd
remove_outliers <- function(x, na.rm = TRUE, ...) {
m <- mean(x, na.rm = na.rm)
sd <- sd(x, na.rm = na.rm, ...)
y <- x
y[x < (m - 3*sd)] <- NA
y[x > (m + 3*sd)] <- NA
y
}
#Total trial
dta_Total <- dta
#Exclusion Trials
dta_Remove <- dta %>%
filter(Correct == 1) %>%
group_by(Subject, Condition) %>%
mutate(RT = remove_outliers(RT)) %>%
na.omit(.)
#Exclusion Rate
dta_ER <- nrow(dta_Remove)/nrow(dta_Total)
dta_ER
#
dta_eli <- dta %>%
filter(Correct == 1) %>%
group_by(Subject, Condition, .drop =FALSE) %>%
mutate(RT = remove_outliers(RT)) %>%
summarize(RT_m=round(mean(RT, na.rm = T), 2), RT_sd=round(sd(RT, na.rm = T), 2),
RT_med=round(median(RT, na.rm = T),0), RT_cov = round(RT_sd/RT_m, 2)) %>%
as.data.frame(.)
write.csv(dta_eli, "results/results_RT.csv")
#
dta_RT_w <- dta_eli %>%
select(-RT_sd, -RT_med, -RT_cov) %>%
gather(key, value, -Condition, -Subject) %>%
unite(col, key, Condition) %>%
spread(col, value) %>%
mutate(MIC = .$RT_m_HH+.$RT_m_LL-.$RT_m_HL-.$RT_m_LH)
write.csv(dta_RT_w, "results/results_RT_w.csv")
#
dta_ACC <- dta_row %>%
select(-RT_m, -RT_sd, -RT_med)
write.csv(dta_ACC, "results/results_ACC.csv")
#
dta_ACC_w <- dta_ACC %>%
gather(key, value, -Condition, -Subject) %>%
unite(col, key, Condition) %>%
spread(col, value)
write.csv(dta_ACC_w, "results/results_ACC_w.csv")
#####
dta$ConditionLR <- factor(dta$Trigger,
levels = c("11", "12", "21", "22", "31", "32", "41", "42", "90"),
labels = c("HH_R", "HH_L", "HL_R", "HL_L", "LH_R", "LH_L", "LL_R", "LL_L", "XX"))
dta_rowLR <- dta %>%
group_by(Subject, ConditionLR) %>%
summarize(ACC_m=round(mean(Correct),2), RT_m=round(mean(RT),2), RT_sd=round(sd(RT),2), RT_med=round(median(RT),0))
write.csv(dta_rowLR, "results/resultsLR_row.csv")
#
dta_eliLR <- dta %>%
filter(Correct == 1) %>%
group_by(Subject, ConditionLR, .drop =FALSE) %>%
mutate(RT = remove_outliers(RT)) %>%
summarize(RT_m=round(mean(RT, na.rm = T), 2), RT_sd=round(sd(RT, na.rm = T), 2),
RT_med=round(median(RT, na.rm = T),0), RT_cov = round(RT_sd/RT_m, 2)) %>%
as.data.frame(.)
write.csv(dta_eliLR, "results/resultsLR_RT.csv")
#
dta_ACCLR <- dta_rowLR %>%
select(-RT_m, -RT_sd, -RT_med)
write.csv(dta_ACCLR, "results/resultsLR_ACC.csv")
#####
dtaforsft <- dta %>%
filter(Correct == "1", RT < 2000, RT > 200) %>%
filter(Condition == "HH"| Condition == "HL"|
Condition == "LH"| Condition == "LL")
dtaforsft$Channel1 <- factor(dtaforsft$Channel1, levels = c('1', '2'),
labels = c('1', '2'))
dtaforsft$Channel2 <- factor(dtaforsft$Channel2, levels = c('1', '2'),
labels = c('1', '2'))
dtaforsft$Condition <- "OR"
dtaforsft$Correct <- 1
#
dtaforsft <- dtaforsft %>%
select(Subject, Condition, Channel1, Channel2, Correct, RT)
## MIC and SIC analysis
sic.res <- sicGroup(dtaforsft)
sic.res$overview
sic.res$sic
?sicGroup
DPtable <- sic.res$sic %>%
modify(~na.omit(c(.[[3]][['positive']]))) %>%
rbindlist() %>%
mutate(statistic = round(statistic,2), p.value = round(p.value,3))%>%
as.data.frame(.)
DNtable <- sic.res$sic %>%
modify(~na.omit(c(.[[3]][['negative']]))) %>%
rbindlist() %>%
mutate(statistic = round(statistic,2), p.value = round(p.value,3))%>%
as.data.frame(.)
MICtable <- sic.res$sic %>%
modify(~na.omit(c(.[[4]]))) %>%
rbindlist() %>%
mutate(statistic = round(statistic,2), p.value = round(p.value,3))%>%
as.data.frame(.)
KStable <- sic.res$sic %>%
modify(~na.omit(c(.[[2]]))) %>%
rbindlist() %>%
mutate(statistic = round(statistic,2), p.value = round(p.value,3))%>%
as.data.frame(.)
SFTTable <- cbind(DPtable, DNtable, MICtable)
SFTTable <- SFTTable[,c(1:3,6:8,11:13)]
#
write.csv(SFTTable, "results/SFTTable.csv")
###
plotdta_mic <- dta %>%
filter(Condition == "HH"| Condition == "HL"| Condition == "LH"| Condition == "LL") %>%
filter(Correct == "1")
plotdta_mic$Channel1 <- factor(plotdta_mic$Channel1, levels = c("1", "2"),
labels = c("L", "H"))
plotdta_mic$Channel2 <- factor(plotdta_mic$Channel2, levels = c("1", "2"),
labels = c("L", "H"))
#line plots for RT
plotdta_mic %>%
group_by(Subject, Condition) %>%
mutate(m_RT=round(mean(RT),2),
se_RT=sd(RT)/sqrt(n())) %>%
ggplot() +
aes(Channel1, m_RT, group = Channel2, shape=Channel2) +
geom_errorbar(aes(ymin=m_RT - se_RT,
ymax=m_RT + se_RT, group=Channel2), color="Black",width=.1, size=.7, position = position_dodge(.1)) +
geom_point(color="Black", size=2, position = position_dodge(.1)) +
geom_line(aes(group=Channel2), position = position_dodge(.1))+
#geom_text(aes(label = m_RT), position = position_dodge(.7), vjust = 0) +
facet_grid(rows = vars(Subject)) +
#scale_y_continuous(limits=c(300, 1000)) +
xlab("Dimenson 1") +
ylab("Reaction Times (msec)") +
theme_bw() +
theme(legend.position = 'top')
rm(list = ls())
## Load Packages
#install.packages("sft")
library(sft)
library(pacman)
p_load(tidyverse, psyphy, lubridate, dplyr, tidyr, data.table, ggpubr, ERP, mnormt, fdrtool, tidyverse, gridExtra, crayon,
boot, reshape2, ggthemes, devtools, sft)
# This part is for data aggregation
# read file path
sft_path <- list.files(path = "data/", pattern = ".csv", full.names = TRUE)
# read file content
sft_data <- sft_path %>%
lapply(read.csv,header=F)
# Unlist and make it as data frame
sft_result <- rbindlist(sft_data, fill = T)
dta <- sft_result %>%
na.omit(.) %>%
as.data.frame(.)
names(dta) <-   c("Subject", "Session", "Target", "Channel1", "Channel2", "TargetLocation", "Trigger", "XX", "XXX", "Fixtime",
"Response", "RT", "Correct")
# Subject Number
nSubjects <- unique(dta$Subject)
nSubjects
#
dta$Condition <- factor(dta$Trigger,
levels = c("11", "12", "21", "22", "31", "32", "41", "42", "90"),
labels = c("HH", "HH", "HL", "HL", "LH", "LH", "LL", "LL", "XX"))
dta$TargetLocation <- factor(dta$TargetLocation,
levels = c("1", "2"),
labels = c("Right", "Left"))
dta$RT <- as.numeric(dta$RT)
dta$Correct <- as.numeric(dta$Correct)
## Show the first six rows
head(dta)
str(dta)
#########
dta_row <- dta %>%
group_by(Subject, Condition) %>%
summarize(ACC_m=round(mean(Correct),2), RT_m=round(mean(RT),2), RT_sd=round(sd(RT),2), RT_med=round(median(RT),0))
write.csv(dta_row, "results/results_row.csv")
# remove outliers mean +- 3 sd
remove_outliers <- function(x, na.rm = TRUE, ...) {
m <- mean(x, na.rm = na.rm)
sd <- sd(x, na.rm = na.rm, ...)
y <- x
y[x < (m - 3*sd)] <- NA
y[x > (m + 3*sd)] <- NA
y
}
#Total trial
dta_Total <- dta
#Exclusion Trials
dta_Remove <- dta %>%
filter(Correct == 1) %>%
group_by(Subject, Condition) %>%
mutate(RT = remove_outliers(RT)) %>%
na.omit(.)
#Exclusion Rate
dta_ER <- nrow(dta_Remove)/nrow(dta_Total)
dta_ER
#
dta_eli <- dta %>%
filter(Correct == 1) %>%
group_by(Subject, Condition, .drop =FALSE) %>%
mutate(RT = remove_outliers(RT)) %>%
summarize(RT_m=round(mean(RT, na.rm = T), 2), RT_sd=round(sd(RT, na.rm = T), 2),
RT_med=round(median(RT, na.rm = T),0), RT_cov = round(RT_sd/RT_m, 2)) %>%
as.data.frame(.)
write.csv(dta_eli, "results/results_RT.csv")
#
dta_RT_w <- dta_eli %>%
select(-RT_sd, -RT_med, -RT_cov) %>%
gather(key, value, -Condition, -Subject) %>%
unite(col, key, Condition) %>%
spread(col, value) %>%
mutate(MIC = .$RT_m_HH+.$RT_m_LL-.$RT_m_HL-.$RT_m_LH)
write.csv(dta_RT_w, "results/results_RT_w.csv")
#
dta_ACC <- dta_row %>%
select(-RT_m, -RT_sd, -RT_med)
write.csv(dta_ACC, "results/results_ACC.csv")
#
dta_ACC_w <- dta_ACC %>%
gather(key, value, -Condition, -Subject) %>%
unite(col, key, Condition) %>%
spread(col, value)
write.csv(dta_ACC_w, "results/results_ACC_w.csv")
#####
dta$ConditionLR <- factor(dta$Trigger,
levels = c("11", "12", "21", "22", "31", "32", "41", "42", "90"),
labels = c("HH_R", "HH_L", "HL_R", "HL_L", "LH_R", "LH_L", "LL_R", "LL_L", "XX"))
dta_rowLR <- dta %>%
group_by(Subject, ConditionLR) %>%
summarize(ACC_m=round(mean(Correct),2), RT_m=round(mean(RT),2), RT_sd=round(sd(RT),2), RT_med=round(median(RT),0))
write.csv(dta_rowLR, "results/resultsLR_row.csv")
#
dta_eliLR <- dta %>%
filter(Correct == 1) %>%
group_by(Subject, ConditionLR, .drop =FALSE) %>%
mutate(RT = remove_outliers(RT)) %>%
summarize(RT_m=round(mean(RT, na.rm = T), 2), RT_sd=round(sd(RT, na.rm = T), 2),
RT_med=round(median(RT, na.rm = T),0), RT_cov = round(RT_sd/RT_m, 2)) %>%
as.data.frame(.)
write.csv(dta_eliLR, "results/resultsLR_RT.csv")
#
dta_ACCLR <- dta_rowLR %>%
select(-RT_m, -RT_sd, -RT_med)
write.csv(dta_ACCLR, "results/resultsLR_ACC.csv")
#####
dtaforsft <- dta %>%
filter(Correct == "1", RT < 2000, RT > 200) %>%
filter(Condition == "HH"| Condition == "HL"|
Condition == "LH"| Condition == "LL")
dtaforsft$Channel1 <- factor(dtaforsft$Channel1, levels = c('1', '2'),
labels = c('1', '2'))
dtaforsft$Channel2 <- factor(dtaforsft$Channel2, levels = c('1', '2'),
labels = c('1', '2'))
dtaforsft$Condition <- "OR"
dtaforsft$Correct <- 1
#
dtaforsft <- dtaforsft %>%
select(Subject, Condition, Channel1, Channel2, Correct, RT)
## MIC and SIC analysis
sic.res <- sicGroup(dtaforsft)
sic.res$overview
sic.res$sic
?sicGroup
DPtable <- sic.res$sic %>%
modify(~na.omit(c(.[[3]][['positive']]))) %>%
rbindlist() %>%
mutate(statistic = round(statistic,2), p.value = round(p.value,3))%>%
as.data.frame(.)
DNtable <- sic.res$sic %>%
modify(~na.omit(c(.[[3]][['negative']]))) %>%
rbindlist() %>%
mutate(statistic = round(statistic,2), p.value = round(p.value,3))%>%
as.data.frame(.)
MICtable <- sic.res$sic %>%
modify(~na.omit(c(.[[4]]))) %>%
rbindlist() %>%
mutate(statistic = round(statistic,2), p.value = round(p.value,3))%>%
as.data.frame(.)
KStable <- sic.res$sic %>%
modify(~na.omit(c(.[[2]]))) %>%
rbindlist() %>%
mutate(statistic = round(statistic,2), p.value = round(p.value,3))%>%
as.data.frame(.)
SFTTable <- cbind(DPtable, DNtable, MICtable)
SFTTable <- SFTTable[,c(1:3,6:8,11:13)]
Sall <- sic.res$overview$Subject
Sall
SFTTable <- cbind(Sall, DPtable, DNtable, MICtable)
View(SFTTable)
SFTTable <- SFTTable[,c(1:4,7:9,12:14)]
View(SFTTable)
View(SFTTable)
Subject <- sic.res$overview$Subject
SFTTable <- cbind(Subject, DPtable, DNtable, MICtable)
SFTTable <- SFTTable[,c(1:4,7:9,12:14)]
View(SFTTable)
#
write.csv(SFTTable, "results/SFTTable.csv")
rm(list = ls())
## Load Packages
#install.packages("sft")
library(sft)
library(pacman)
p_load(tidyverse, psyphy, lubridate, dplyr, tidyr, data.table, ggpubr, ERP, mnormt, fdrtool, tidyverse, gridExtra, crayon,
boot, reshape2, ggthemes, devtools, sft)
# This part is for data aggregation
# read file path
sft_path <- list.files(path = "data/", pattern = ".csv", full.names = TRUE)
# read file content
sft_data <- sft_path %>%
lapply(read.csv,header=F)
# Unlist and make it as data frame
sft_result <- rbindlist(sft_data, fill = T)
dta <- sft_result %>%
na.omit(.) %>%
as.data.frame(.)
# Column 1: Subject
# Column 2: Session
# Column 3: Target (0: target absent, 1: target present)
# Column 4: Dimension 1 (0: no, 1: low, 2: high)
# Column 5: Dimension 2 (0: no, 1: low, 2: high)
# Column 6: Target on the left or right 1 (1: right, 2: left) p.s. not meaningful for the target absent condition
# Column 7: Trigger number (11: HH and right target; 12: HH and left target; 21: HL and right target; 22: HL and left target; 31: LH and right target; 32: LH and left target; 41: LL and right target; 42: LL and left target; 90: XX and no target)
# Column 8: PIC index (for programming)
# Column 9: PIC name (for programming)
# Column 10: Fixation Time (ms unit)
# Column 11: Response (-1: no response, 1: target absent, 2: target present)
# Column 12: Response Time (ms unit)
# Column 13: Accuracy (0: incorrect, 1: correct)
names(dta) <-   c("Subject", "Session", "Target", "Channel1", "Channel2", "TargetLocation", "Trigger", "XX", "XXX", "Fixtime",
"Response", "RT", "Correct")
# Save data
#write.csv(dta, "/Users/haolunfu/Documents/VO2_EF_SFT/Pretest_all.csv")
# Subject Number
nSubjects <- unique(dta$Subject)
nSubjects
#
dta$Condition <- factor(dta$Trigger,
levels = c("11", "12", "21", "22", "31", "32", "41", "42", "90"),
labels = c("HH", "HH", "HL", "HL", "LH", "LH", "LL", "LL", "XX"))
dta$TargetLocation <- factor(dta$TargetLocation,
levels = c("1", "2"),
labels = c("Right", "Left"))
dta$RT <- as.numeric(dta$RT)
dta$Correct <- as.numeric(dta$Correct)
## Show the first six rows
head(dta)
str(dta)
#########
dta_row <- dta %>%
group_by(Subject, Condition) %>%
summarize(ACC_m=round(mean(Correct),2), RT_m=round(mean(RT),2), RT_sd=round(sd(RT),2), RT_med=round(median(RT),0))
write.csv(dta_row, "results/results_row.csv", row.names = F)
# remove outliers mean +- 3 sd
remove_outliers <- function(x, na.rm = TRUE, ...) {
m <- mean(x, na.rm = na.rm)
sd <- sd(x, na.rm = na.rm, ...)
y <- x
y[x < (m - 3*sd)] <- NA
y[x > (m + 3*sd)] <- NA
y
}
#Total trial
dta_Total <- dta
#Exclusion Trials
dta_Remove <- dta %>%
filter(Correct == 1) %>%
group_by(Subject, Condition) %>%
mutate(RT = remove_outliers(RT)) %>%
na.omit(.)
#Exclusion Rate
dta_ER <- nrow(dta_Remove)/nrow(dta_Total)
dta_ER
#
dta_eli <- dta %>%
filter(Correct == 1) %>%
group_by(Subject, Condition, .drop =FALSE) %>%
mutate(RT = remove_outliers(RT)) %>%
summarize(RT_m=round(mean(RT, na.rm = T), 2), RT_sd=round(sd(RT, na.rm = T), 2),
RT_med=round(median(RT, na.rm = T),0), RT_cov = round(RT_sd/RT_m, 2)) %>%
as.data.frame(.)
write.csv(dta_eli, "results/results_RT.csv", row.names = F)
#
dta_RT_w <- dta_eli %>%
select(-RT_sd, -RT_med, -RT_cov) %>%
gather(key, value, -Condition, -Subject) %>%
unite(col, key, Condition) %>%
spread(col, value) %>%
mutate(MIC = .$RT_m_HH+.$RT_m_LL-.$RT_m_HL-.$RT_m_LH)
write.csv(dta_RT_w, "results/results_RT_w.csv", row.names = F)
#
dta_ACC <- dta_row %>%
select(-RT_m, -RT_sd, -RT_med)
write.csv(dta_ACC, "results/results_ACC.csv", row.names = F)
#
dta_ACC_w <- dta_ACC %>%
gather(key, value, -Condition, -Subject) %>%
unite(col, key, Condition) %>%
spread(col, value)
write.csv(dta_ACC_w, "results/results_ACC_w.csv", row.names = F)
#####
dta$ConditionLR <- factor(dta$Trigger,
levels = c("11", "12", "21", "22", "31", "32", "41", "42", "90"),
labels = c("HH_R", "HH_L", "HL_R", "HL_L", "LH_R", "LH_L", "LL_R", "LL_L", "XX"))
dta_rowLR <- dta %>%
group_by(Subject, ConditionLR) %>%
summarize(ACC_m=round(mean(Correct),2), RT_m=round(mean(RT),2), RT_sd=round(sd(RT),2), RT_med=round(median(RT),0))
write.csv(dta_rowLR, "results/resultsLR_row.csv", row.names = F)
#
dta_eliLR <- dta %>%
filter(Correct == 1) %>%
group_by(Subject, ConditionLR, .drop =FALSE) %>%
mutate(RT = remove_outliers(RT)) %>%
summarize(RT_m=round(mean(RT, na.rm = T), 2), RT_sd=round(sd(RT, na.rm = T), 2),
RT_med=round(median(RT, na.rm = T),0), RT_cov = round(RT_sd/RT_m, 2)) %>%
as.data.frame(.)
write.csv(dta_eliLR, "results/resultsLR_RT.csv", row.names = F)
#
dta_ACCLR <- dta_rowLR %>%
select(-RT_m, -RT_sd, -RT_med)
write.csv(dta_ACCLR, "results/resultsLR_ACC.csv", row.names = F)
#####
dtaforsft <- dta %>%
filter(Correct == "1", RT < 2000, RT > 200) %>%
filter(Condition == "HH"| Condition == "HL"|
Condition == "LH"| Condition == "LL")
dtaforsft$Channel1 <- factor(dtaforsft$Channel1, levels = c('1', '2'),
labels = c('1', '2'))
dtaforsft$Channel2 <- factor(dtaforsft$Channel2, levels = c('1', '2'),
labels = c('1', '2'))
dtaforsft$Condition <- "OR"
dtaforsft$Correct <- 1
#
dtaforsft <- dtaforsft %>%
select(Subject, Condition, Channel1, Channel2, Correct, RT)
## MIC and SIC analysis
sic.res <- sicGroup(dtaforsft)
sic.res$overview
sic.res$sic
?sicGroup
DPtable <- sic.res$sic %>%
modify(~na.omit(c(.[[3]][['positive']]))) %>%
rbindlist() %>%
mutate(statistic = round(statistic,2), p.value = round(p.value,3))%>%
as.data.frame(.)
DNtable <- sic.res$sic %>%
modify(~na.omit(c(.[[3]][['negative']]))) %>%
rbindlist() %>%
mutate(statistic = round(statistic,2), p.value = round(p.value,3))%>%
as.data.frame(.)
MICtable <- sic.res$sic %>%
modify(~na.omit(c(.[[4]]))) %>%
rbindlist() %>%
mutate(statistic = round(statistic,2), p.value = round(p.value,3))%>%
as.data.frame(.)
KStable <- sic.res$sic %>%
modify(~na.omit(c(.[[2]]))) %>%
rbindlist() %>%
mutate(statistic = round(statistic,2), p.value = round(p.value,3))%>%
as.data.frame(.)
Subject <- sic.res$overview$Subject
SFTTable <- cbind(Subject, DPtable, DNtable, MICtable)
SFTTable <- SFTTable[,c(1:4,7:9,12:14)]
#
write.csv(SFTTable, "results/SFTTable.csv", row.names = F)
